import hashlib
import base58

def create_peer_did(pub_key_hex):
    # Simplified Peer DID Method 2
    multicodec_key = b'\x12\x20' + hashlib.sha256(bytes.fromhex(pub_key_hex)).digest()
    encoded_key = base58.b58encode(multicodec_key).decode('utf-8')
    return f"did:peer:2.Vz{encoded_key}"

def update_did(old_did, new_pub_key_hex):
    # Simple rotation: create new DID
    return create_peer_did(new_pub_key_hex)
